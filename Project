The Input Table component extracts KYC trade transaction data from the staging table KYC_RGN_STG.TRADE_TXN_SMRY and joins it with the exception log table KYC_GBL_MAIN.GIW_BATCH_EXCP_LOG to identify records that previously failed processing.
The join is performed on the fields ID, ID_TYPE, MONTH, YEAR, COUNTRY, and CLIENT_TYPE, ensuring that only matching records between staging and exception log are selected.
Additionally, the query enriches the data with the business unit (GIW_BUSINESS_UNIT) from the exception log, exposed as CLIENT_SEGMENT_TYPE.
Records are filtered to include only those created in the last 730 days (based on CREATE_DT) to avoid processing outdated data.
The resulting dataset contains all staging fields along with the derived CLIENT_SEGMENT_TYPE and is passed to the next stage (PBKS) for partitioning and sorting.
