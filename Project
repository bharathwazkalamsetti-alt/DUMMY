Absolutely — here is **Update Failure (Read Only)** again, now with the **business_logic** section fully populated in your mini-table style (ready to paste into your Excel).

---

| **Column Name**         | **Value**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| ----------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Graph_Name**          | Update_Failure_Graph                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **Sub Graph**           | Update Failure (Read Only)                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **Comments**            | Reads batch control file, enriches with audit fields, and updates KYC batch statistics to **FAILED**.                                                                                                                                                                                                                                                                                                                                                                                               |
| **type_of_action**      | Update                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **source_app**          | Ab Initio                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **source_host**         | localhost                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **source_path**         | `/home/bk40980/private_sand/GFTS/KYC/etl_interfaces/graphs/update_failure.grf`                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **source_db**           | File System                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **source_table**        | Batch_File (input control dataset)                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **source_fileds**       | `batch_dt, batch_id, process_date, rgn_id, cntry_cd`                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **source_data_type**    | Mixed (String, Date)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **source_files_length** | Variable                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **business_logic**      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|                         | *File System* | *Batch File (Input)* | `batch_dt, batch_id, process_date, rgn_id, cntry_cd` | *Reformat* | Reads batch control record from `file:$FILE` (DML shows delimited date/ID fields). Identifies the exact batch/run to be marked as **FAILED**.                                                                                                                                                                                                                                            |
|                         | *N/A (Ab Initio internal)* | *Reformat Transform* | Adds/cleans fields → `lst_upd_dt, lst_upd_time, lst_upd_id; batch_id, rgn_id, cntry_cd, process_date` | *Update Table* | Embedded transform prepares update-ready row: `lst_upd_dt = (date('YYYYMMDD')) now(); lst_upd_time = ${LAST_UPD_TIME}; lst_upd_id = '${CREATE_ID}'; batch_id = string_ltrim(in.batch_id); rgn_id = string_ltrim(in.rgn_id); cntry_cd = string_ltrim(in.cntry_cd); process_date = (date('YYYYMMDD')) in.process_date;`. |
|                         | *Oracle Target* | *KYC_RGN_MAIN.KYC_BATCH_STATISTICS* | `LST_UPD_ID, LST_UPD_DT, LST_UPD_TIME, BATCH_STATUS` | *Update Table (Oracle)* | Executes embedded SQL via `${DBC_FILE}` to flag failure: `UPDATE KYC_RGN_MAIN.KYC_BATCH_STATISTICS SET LST_UPD_ID = :lst_upd_id, LST_UPD_DT = :lst_upd_dt, LST_UPD_TIME = :lst_upd_time, BATCH_STATUS = 'FAILED' WHERE BATCH_ID = :batch_id AND PROCESS_DATE = :process_date AND RGN_ID = :rgn_id AND CNTRY_CD = :cntry_cd;`.                              |
| **target_app**          | Oracle                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **target_host**         | oracle_host                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **target_path**         | `${OUTPUT_PATH}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **target_File**         | N/A                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **target_table**        | `KYC_RGN_MAIN.KYC_BATCH_STATISTICS`                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **target_Key**          | `batch_id, process_date, rgn_id, cntry_cd`                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **target_filed**        | `lst_upd_id, lst_upd_dt, lst_upd_time, batch_status`                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **target_field_type**   | String / Date                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **target_field_length** | Variable                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **Query**               | Uses `${DBC_FILE}` to run the above `UPDATE` and mark the batch **FAILED**, updating audit fields with current date/time and user.                                                                                                                                                                                                                                                                                                                                                                  |

If you’d like, I can also produce the same for **Update (success)** with `BATCH_STATUS = 'SUCCESS'`.
