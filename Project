| **Column Name**         | **Value**                                                                                                                                                                                                                                                                                                                          |
| ----------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Graph_Name**          | Update_Load_Graph                                                                                                                                                                                                                                                                                                                  |
| **Sub Graph**           | Update (Read Only)                                                                                                                                                                                                                                                                                                                 |
| **Comments**            | Reads batch/control inputs and processed stats, computes success/failure totals, and **updates** the batch statistics table. Errors flow to an error file.                                                                                                                                                                         |
| **type_of_action**      | Update                                                                                                                                                                                                                                                                                                                             |
| **source_app**          | File System / Ab Initio                                                                                                                                                                                                                                                                                                            |
| **source_host**         | unix host                                                                                                                                                                                                                                                                                                                          |
| **source_path**         | `file:$PROCESSED_STATS_FILE`, `file:$REJECTS_LR`, *(Batch File from prior step)*                                                                                                                                                                                                                                                   |
| **source_db**           | N/A                                                                                                                                                                                                                                                                                                                                |
| **source_table**        | `Batch File`, `PROCESSED_STATS File`, `Reject Lr`                                                                                                                                                                                                                                                                                  |
| **source_fileds**       | `batch_dt, batch_id, process_date, rgn_id, cntry_cd` (Batch File) · `tot_rec_processed, rejected_rec, success_rec` (Processed Stats) · `line` (Reject LR)                                                                                                                                                                          |
| **source_data_type**    | Mixed (date, string, number)                                                                                                                                                                                                                                                                                                       |
| **source_files_length** | Variable                                                                                                                                                                                                                                                                                                                           |
| **business_logic**      |                                                                                                                                                                                                                                                                                                                                    |
|                         | *File System* | *Batch File* | `batch_dt, batch_id, process_date, rgn_id, cntry_cd` | *Join* | Reads batch control metadata from the input batch file (record format shows dates and IDs). Feeds as one input into the **Join**.                                                                                                   |
|                         | *File System* | *PROCESSED_STATS File* | `tot_rec_processed, success_rec, rejected_rec` | *Join* | Reads run statistics (`file:$PROCESSED_STATS_FILE`). Provides totals processed/success/reject counts as a second input to **Join**.                                                                                             |
|                         | *File System* | *Reject Lr* | `line` | *RLP* | Reads reject log records (`file:$REJECTS_LR`). **Rollup (RLP)** computes `count(in.line)` to produce a reject count (unsorted input, in-memory rollup).                                                                                                                             |
|                         | *Transform* | *RLP ➜ output count* | `count` | *Join* | The **RLP** output (reject count) is fed as the third input to **Join**.                                                                                                                                                                                                   |
|                         | *Transform* | *Join* | all incoming fields | *Update Table* | **Join** (Built-in, Full Outer Join) merges the three inputs and derives metrics (e.g., `total_process_cnt`, `success_cnt`, `failure_cnt`) using embedded transform logic (uses `first_defined(...)` across inputs).                                                 |
|                         | *Oracle Target* | *KYC_RGN_MAIN.KYC_BATCH_STATISTICS* | `TOTAL_PROCESS_CNT, SUCCESS_CNT, FAILURE_CNT, LST_UPD_ID, LST_UPD_TS` | *Update Table* | **Update Table** executes embedded SQL against Oracle using `$DBC_FILE`. Updates batch statistics for the run. Rejects (if any) are written to **Err File** (`file:$ERROR_FILE`). |
| **target_app**          | Oracle                                                                                                                                                                                                                                                                                                                             |
| **target_host**         | oracle_host                                                                                                                                                                                                                                                                                                                        |
| **target_path**         | `$ERROR_FILE` (for error output)                                                                                                                                                                                                                                                                                                   |
| **target_File**         | `Err File`                                                                                                                                                                                                                                                                                                                         |
| **target_table**        | `KYC_RGN_MAIN.KYC_BATCH_STATISTICS`                                                                                                                                                                                                                                                                                                |
| **target_Key**          | N/A (driven by SQL’s WHERE clause/keys inside DB)                                                                                                                                                                                                                                                                                  |
| **target_filed**        | `TOTAL_PROCESS_CNT, SUCCESS_CNT, FAILURE_CNT, LST_UPD_ID, LST_UPD_TS`                                                                                                                                                                                                                                                              |
| **target_field_type**   | Numeric & Varchar/Date (per Oracle table DDL)                                                                                                                                                                                                                                                                                      |
| **target_field_length** | As per table DDL (not changed by graph)                                                                                                                                                                                                                                                                                            |
| **Query**               | `UPDATE KYC_RGN_MAIN.KYC_BATCH_STATISTICS  SET  TOTAL_PROCESS_CNT = :total_process_cnt,  SUCCESS_CNT = :success_cnt,  FAILURE_CNT = :failure_cnt,  LST_UPD_ID = :lst_upd_id,  LST_UPD_TS = :lst_upd_ts  /* + any additional predicates in embedded SQL; connection via $DBC_FILE */`                                               |
