# ------------------------------------------------------------
# 6. Apply schema to DataFrame
# ------------------------------------------------------------

print("Applying schema to DataFrame")
print("Before applying schema")
df_raw.show(5)

# Rename _1, _2, _3... to actual column names from schema
for i, col_name in enumerate(schema):
    df_raw = df_raw.withColumnRenamed(f"_{i+1}", col_name)

print("After applying schema")
df_raw.show(5)
