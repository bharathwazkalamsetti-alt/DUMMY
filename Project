# ----------------------------- 5. File validation -----------------------------

file_date_match = (file_date == header_filedate)
print(f"File Date Validation Match | File Date: {file_date} | Header Filedate:{header_filedate} | File Date Match: {file_date_match}")

row_count_match = (source_count == footer_count)
print(f"Row Count Validation Match | Source Count: {source_count} | Footer Count: {footer_count} | Row Count Match: {row_count_match}")

# checksum removed because not used now
# checksum_match = (final_checksum == footer_chksum)
# print(f"Checksum Validation Match | Computed Checksum: {final_checksum} | Footer Checksum: {footer_chksum} | Checksum Match: {checksum_match}")

audit_status = "PASSED" if (file_date_match and row_count_match) else "FAILED"

update_audit_log(spark,audit_id,audit_status,"File validation completed",int(source_count),start_time)

print(f"Audit Log Updated with Status: {audit_status}")

if not (file_date_match and row_count_match):
    print("File validation failed. Exiting process.")
    update_audit_log(spark, audit_id, "FAILED", "File validation failed", int(source_count), start_time)
    return

print("File validation passed. Continuing with the process.")
